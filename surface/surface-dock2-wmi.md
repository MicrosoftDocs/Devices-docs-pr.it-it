---
title: Gestire Surface Dock 2 con WMI
description: Questo articolo spiega come usare WMI per monitorare e gestire in remoto il firmware più recente, lo stato dei criteri e i dati correlati tra i dispositivi Surface Dock 2.
ms.prod: w10
ms.mktglfcycl: manage
ms.localizationpriority: medium
ms.sitesec: library
author: coveminer
ms.author: greglin
ms.topic: article
ms.date: 10/12/2020
ms.reviewer: hachidan
manager: laurawi
audience: itpro
ms.openlocfilehash: 06933d49e99862fb19d0f6a09c9680a127b755cd
ms.sourcegitcommit: c1efb75e8524193bdc0a5f7496dc23a92ac665c8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/12/2020
ms.locfileid: "11114654"
---
# Gestire Surface Dock 2 con WMI

Il supporto di Strumentazione gestione Windows (WMI) offre un ricco set di informazioni di diagnostica che consente agli amministratori IT di monitorare e gestire in remoto il firmware più recente, lo stato dei criteri e i dati correlati tra i dispositivi Surface Dock 2. È possibile usare WMI con Windows PowerShell, System Center Operations Manager e altri strumenti. Per altre informazioni su WMI, vedere [uso di WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true). 

Per abilitare il supporto WMI, passa a [Surface Dock 2 driver e firmware](https://www.microsoft.com/download/details.aspx?id=101317) e Scarica il pacchetto appropriato:

**SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versione # C1_x64.msi:**<br>

- Surface Pro (5a generazione e versioni successive)
- Surface Book (2a generazione e versioni successive)
- Surface Go (tutte le generazioni)
- Laptop Surface (tutte le generazioni)
- Portatile Surface go

 **SurfaceDock2_WmiInstanceProvider_Win10_17763_&#60;versione # C1_arm64.msi:** <br>

- Surface Pro X

## Uso di WMI con Surface Dock 2

1. Per enumerare tutte le istanze del componente Dock:

    ```PowerShell
    Get-CimInstance -Namespace "root/Surface" -Class "SurfaceDockComponent" 
    ```
2. Per accedere alle descrizioni delle proprietà della classe WMI, aprire un prompt dei comandi e immettere i controlli WMI in cui la **Proprietà** è una delle proprietà elencate nella tabella 1.

    ```PowerShell
     Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["<Property>"]
    ```

- **Esempio:** Per accedere alla descrizione della proprietà CIM ( **Version** Common Information Model), immettere quanto segue:
    ```PowerShell
    (Get-CimClass -Namespace "root/Surface" -Class "SurfaceDockComponent").CimClassProperties["Version"].Qualifiers["Description"].Value
    ```
 
 ### Tabella 1. Riferimento WMI per Surface Dock 2

| Proprietà         | Tipo   | Valori previsti                                                                                                                                                                                                            | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ---------------- | ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ComponentName    | Stringa | Microcontroller <br>"Hub USB 1" <br>"Hub USB 2" <br>"Visualizza hub della porta" <br>"Controller di Power Delivery" <br>"Codec audio" <br>"Controller Ethernet"                                                                         | La proprietà seguente elenca il nome specifico del componente del dispositivo a cui corrispondono i dati della classe CIM (Common Information Model) che lo accompagna.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| DeviceName       | Stringa | "Surface Dock 1" <br>"Surface Dock 2"                                                                                                                                                                                        | La proprietà seguente contiene il nome del dispositivo dock a cui appartiene il componente specifico del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| DockSerialNumber | Stringa | Numero seriale di dodici (12) cifre che contiene solo valori numerici                                                                                                                                                           | La proprietà seguente registra il numero seriale del dispositivo Dock allegato. Questo numero seriale è lo stesso identico per tutti i componenti che appartengono allo stesso dispositivo Dock. Per riferimento, questo numero seriale può essere trovato fisicamente nella parte inferiore del Dock Surface stesso.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Id               | UInt16 | 0, 1, 2,..., 65535                                                                                                                                                                                                          | La proprietà seguente è un ID univoco che inizia da zero (0) e conta in su. Questa variabile viene usata per numerare le istanze WMI enumerate.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| LastUpdateStatus | Stringa | Successo <br>"PendingDockReattach" <br>Fallito                                                                                                                                                                             | La proprietà seguente descrive in dettaglio lo stato dell'ultimo tentativo di aggiornamento del firmware del componente (CFU) per il componente del dispositivo in questione. I valori possibili sono: **successo,** **riattaccamento del Dock in sospeso** e **non riuscito.**<br><br><br>- Il **successo** indica che il nuovo firmware applicato in precedenza è stato applicato correttamente<br>- La **riconnessione del Dock in sospeso** indica che è presente un nuovo aggiornamento in sospeso per il componente dispositivo e che l'utente deve scollegare e riconnettere il connettore Surface del dock per applicare il nuovo aggiornamento.<br>- Non **riuscito** indica che si è verificato un possibile errore legittimo durante il processo CFU o che la periferica non è stata avviata nella versione prevista. Nel caso non **riuscito** , non si tratta di un'indicazione che il dispositivo non funziona, ma si è verificato un errore quando si tenta di aggiornare il dispositivo. In questo caso, il firmware precedente continuerà a essere eseguito.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| PolicyState      | Stringa | Abilitato <br>Disabilitato                                                                                                                                                                                                     | La proprietà seguente indica il criterio SEMM (Surface Enterprise Management Mode) corrente per il componente dispositivo. I valori possibili sono: **Enabled** e **disabled.**<br><br><br>- **Enabled** indica che il sistema SEMM ha consentito al dispositivo host di accedere e usare il componente dispositivo<br>- **Disabled** indica che il sistema SEMM non è consentito e quindi ha impedito al computer host di accedere e usare il componente dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProductId        | Stringa [] | Un elenco di stringhe esadecimali, che possono variare da "0x0000" a "0xFFFF"                                                                                                                                                        | La proprietà seguente classifica l'ID prodotto (PID) del componente dispositivo. È possibile che sia presente più di un PID elencato. Nel caso di un hub USB, ad esempio, i dispositivi Super Speed (SS) e High Speed (HS) vengono raggruppati in un singolo hub. Di conseguenza, due (2) PID verrebbero elencati all'interno di questa matrice.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| ProvisionedState         | boolean | Vero o falso                                                                                                                                                        | La proprietà seguente descrive lo stato di provisioning della modalità di gestione di Surface Enterprise (SEMM) del dispositivo Surface Dock. Lo stato di cui è stato eseguito il provisioning è lo stesso identico per tutti i componenti che appartengono allo stesso dispositivo Dock. I valori possibili sono: vero o falso. Il valore true indica che il dispositivo Surface Dock è attualmente gestito e, quindi, la funzionalità porta può essere limitata. Per altre informazioni, Vedi il campo della proprietà "PolicyState". Il valore false indica che il dispositivo Surface dock non è attualmente gestito e non ha restrizioni di funzionalità imposte.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Stato           | Stringa | OK <br>Scollegato <br>Errore <br>Mancanti <br>"DeviceHandleInUse" <br>Disabilitato <br>"NotSupportedByWmi"                                                                                                             | La proprietà seguente descrive lo stato della connessione del dock al computer host. I valori possibili sono: **OK,** **disconnected,** **Error,** **Missing,** **DeviceHandleInUse,**  **disabled** e **NotSupportedByWmi.** <br>- **OK** indica che il dispositivo è connesso correttamente al computer host e che non esistono problemi, che ne inibiscono la funzionalità <br>- **Disconnected** indica che il connettore Surface, che fornisce la connessione per tutti i componenti del dispositivo, non è attualmente collegato al computer host. <br>- L' **errore** indica un potenziale problema con l'istanza del dispositivo e l'interfaccia del dispositivo ha più che probabile l'etichetta con un punto esclamativo giallo in gestione dispositivi: verificare la proprietà **statusCode** per informazioni più dettagliate sul tipo di errore che si è verificato. <br>- **Missing** indica che il dispositivo dovrebbe essere stato enumerato nel computer host, ma per qualche motivo non è stato eseguito. La proprietà **statusCode** conterrà il valore 24 per indicare questa situazione errata.<br>- **DeviceHandleInUse** indica che un altro processo sta attualmente comunicando con il dispositivo, che impedisce il provider di istanze di Windows Management Instrumentation (WMI) dalle richieste di comunicazione. Provare a eseguire di nuovo il comando WMI. <br> - **Disabled** indica che i criteri correnti della modalità di gestione di Surface Enterprise (SEMM) non sono consentiti e quindi impedito al computer host di accedere e usare il componente dispositivo. Per altre informazioni, Vedi il campo della proprietà **PolicyState** .<br>- **NotSupportedByWmi** indica che il Dock connesso non è attualmente supportato da questo provider WMI. Questo stato verrà visualizzato per Surface Dock 1, che attualmente non è supportato da questo provider di istanze WMI.|
| StatusCode       | UInt32 | [Codice di errore di gestione di dispositivi](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages) ottenuto dalla classe WMI CIM_LogicalDevice (all'interno di *cimwin32. mof*) | La proprietà seguente fornisce il codice di errore di gestione dispositivi per il componente Dock specifico. Un valore pari a zero (0) indica che il componente Dock funziona correttamente; un valore maggiore di zero (0) indica un problema o un possibile errore con il componente Dock. Poiché il componente Dock può enumerare diverse interfacce di dispositivo, è possibile che siano presenti altri codici di errore di gestione dispositivi. Questo campo della proprietà elenca solo un singolo codice di errore, anche se sono disponibili più elementi. Gestione dispositivi etichetta il dispositivo con un punto esclamativo giallo solo quando si sono verificati alcuni codici di errore.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| VendorId         | Stringa | Stringa esadecimale che può variare da "0x0000" a "0xFFFF"                                                                                                                                                                        | La proprietà seguente nota lo specifico ID fornitore (VID) del componente dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Versione          | Stringa | Stringa della versione, che ha la forma seguente: "x. y. z", dove x, y e z sono valori numerici.                                                                                                                            | La proprietà seguente specifica la versione corrente del firmware, attualmente in esecuzione nel componente del dispositivo.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |


## Scopri di più

- [Proteggere le porte del Surface Dock 2 con SEMM](secure-surface-dock-ports-semm.md)
- [Novità di Surface Dock 2](surface-dock-whats-new.md)
- [Codici di errore di gestione dispositivi](https://docs.microsoft.com/windows-hardware/drivers/install/device-manager-error-messages)
- [Uso di WMI](https://docs.microsoft.com/powershell/scripting/learn/ps101/07-working-with-wmi?&preserve-view=true)
